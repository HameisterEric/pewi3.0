<html>
<head>
<style>

* {
  -webkit-touch-callout: none; /* iOS Safari */
  -webkit-user-select: none;   /* Chrome/Safari/Opera */
  -khtml-user-select: none;    /* Konqueror */
  -moz-user-select: none;      /* Firefox */
  -ms-user-select: none;       /* Internet Explorer/Edge */
  user-select: none;           /* Non-prefixed version, currently
                                  not supported by any browser */
}


body{
    background-color: black;
}

.button {
position:relative;
display: inline-block;
background-color: #40A4DF ;
width:400px;
border-radius:12px;
height:50px ;
color: white ;
padding:5px;
border: 2px solid white;
cursor: all-scroll ;
font-family: 'Amatic SC', cursive;
text-align:center;
line-height: 130%;
color: #FFFFFF;
font-size: 40px ;
font-weight: bold;
margin-top:40px;
}

.button:hover {
 background-color:  #7cc1e9 ;
}   

#backButton {
    position:relative;
    display:inline-block;
    margin-left:10%;
    margin-top:30px;
    padding: 5px;
}   

#backButton:hover {
    border-bottom: 2px solid white;
}

#contentsHolder{
    position:absolute;
    margin-left:-205px;
    left:50%;
    width:410px;
    height:100%;

}

#textInfo{
    width:100%;
    margin-top:35px;
    border-radius: 6px;
    text-align:left;
    padding:10px;
    line-height:110%;
    height:240px;
    background-color: white;
    color:#000000;
    font-family: Arial, "Helvetica Neue", Helvetica, sans-serif;
    font-size:20px;
    
}

#players {
  width:300px;
  background-color: #40A4DF  ;
  border: 3px solid white;
  display: inline-block;  
  padding:5px;
  text-align:center;
  font-family: 'Amatic SC', cursive;
  color: #FFFFFF;
  font-size: 40px ;
  font-weight: bold;
  margin: 20px;
  margin-left:25px;
  margin-top:50px;
  padding: 15px 30px 15px 30px;
  
}

.math {
  width:20px; 
  cursor:default; 
  display:inline-block;
}

.math:hover {
  color: #990033;  
}

</style>    

<script src="filesaver.min.js"></script>
<script src="jszip.min.js"></script> 
 
</head>    

<link href='https://fonts.googleapis.com/css?family=Amatic+SC:700' rel='stylesheet' type='text/css'>
    
<body>

<img onclick="parent.hideMultiDownload();" id="backButton" src="./imgs/back.png">  

<div id="contentsHolder">

<div id="innerContainer">
<div id="textInfo">
Select the number of players you have assigned. Note that the players must be assigned in order. That is, if you 
are using a maximum of 4 players, it should be assigned with players 1 through 4 and not 3 through 6. When you are
ready, click download to save the zipped file.<br><br>Individual files can be distributed, modified, and then recombined
(via utilities) to view aggregate results.    
</div>

<div id="players">
<div style="cursor:default; display:inline-block;" id="title">Assigned Players: </div> 

<div style="cursor:default; display:inline-block;" id="playerNumber">6</div>
<div id="subPlayer" style="margin-left:20px;" onclick="changeYearValue(-1)" class="math"><b>&ndash;</b></div>
|
<div id="addPlayer" style="visibility:hidden" onclick="changeYearValue(+1)" class="math"><b>+</b></div>
</div>

<div id="download" onclick="createDownload();" class="button">Download Multi-Map File</div>       
</div>

<div id="exit" style="visibility:hidden;" onclick="exitToMain();" class="button">Return to Start</div>       

</div>

</body>    
      
    
<script>
var zip = new JSZip();
var maxPlayers = 6 ;

function addToZip(playerNumber) {

 var data = parent.createPlayerMap(playerNumber) ;
  
 //jszip 
 zip.file("player" + playerNumber + ".csv", data);

}  
    
    
function createDownload() {
    
    var assignedPlayers = Number(document.getElementById('playerNumber').innerHTML) ;
    
    for(var k=1; k <= assignedPlayers; k++){
        addToZip(k) ;
    }

 zip.generateAsync({type:"blob"})
.then(function (blob) {
    //filesaver.min.js
    saveAs(blob, "PEWI_multi-maps.zip");
});

document.getElementById('backButton').style.display = "none";
document.getElementById('innerContainer').style.display = "none";
document.getElementById('exit').style.visibility = "visible" ;

}


function changeYearValue(value) {

var number = Number(document.getElementById('playerNumber').innerHTML) ;

number += value ;

document.getElementById('addPlayer').style.visibility = "visible" ;
document.getElementById('subPlayer').style.visibility = "visible" ;

if(number == maxPlayers){
  document.getElementById('addPlayer').style.visibility = "hidden" ;
}
else if(number == 1){
  document.getElementById('subPlayer').style.visibility = "hidden" ;
}


document.getElementById('playerNumber').innerHTML  = number ;
  
} 
    
function exitToMain() {
    window.top.location.reload();
}    
    
</script>    
    
    
</html>