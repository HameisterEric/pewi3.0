<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">

<style>
body {
	background-color: #FFFFFF;
	margin: 0;
	overflow: hidden;
	}
	
.right {
    position: absolute;
    background-color: rgba(159, 197, 209, 0.5);
    right: 0px;
    width: 200px;
    height: 300px;
    padding: 10px;
}
</style>

</head>
	
<body>
    
<div class="right">
  <p>Development Controls</p>
  <button>---</button>
  <p>Camera Position</p>
  <p id="pos"></p>
</div>

<script src="./three.min.js"></script>
<script src="./controls.js"></script>
<script src="./loader.js"></script>

<script>

//global vars
var camera, scene, renderer;
var controls ;

function updateHUD() {
    var text ;
    text = "x: " + Math.floor(camera.position.x) ;
    text += "  y: " + Math.floor(camera.position.y) ;
    text += "  z: " + Math.floor(camera.position.z)  ;
    text += "<br>";
    text += "  rx: " + Math.floor(camera.rotation.x) ;
    text += "  ry: " + Math.floor(camera.rotation.y) ;
    text += "  rz: " + Math.floor(camera.rotation.z) ;
    
    document.getElementById("pos").innerHTML = text ;
}

function onResize() {
    camera.aspect = window.innerWidth / window.innerHeight;
    camera.updateProjectionMatrix();
    renderer.setSize(window.innerWidth, window.innerHeight);
  }

function setup() {

    scene = new THREE.Scene();
    
    //camera
     var SCREEN_WIDTH = window.innerWidth, SCREEN_HEIGHT = window.innerHeight;
     var ASPECT = SCREEN_WIDTH / SCREEN_HEIGHT, NEAR = 0.1, FAR = 10000;
     camera = new THREE.PerspectiveCamera(75, ASPECT, NEAR, FAR);
     scene.add(camera);
    
    //renderer
    renderer = new THREE.WebGLRenderer();
    
    //lighting
    var hemiLight = new THREE.HemisphereLight(0xffffff, 0xffffff, 1 );
    hemiLight.position.set( 0, 30, 100);
    scene.add( hemiLight );

	 //set up camera
    camera.position.y = 320;
    camera.position.z = 18;
    camera.rotation.x = -45 * Math.PI / 180;

    //set up renderer
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);


    //set up controls
    controls = new THREE.OrbitControls( camera, renderer.domElement );

    updateHUD() ;
}

function setupSpace() {

    //skybox

    //for (var i = 0; i < 6; i++) materialArray[i].side = THREE.BackSide;
    var skyboxMaterial = new THREE.MeshFaceMaterial( materialArray );
    var skyboxGeom = new THREE.CubeGeometry( 5000, 5000, 5000, 1, 1, 1 );
    var skybox = new THREE.Mesh( skyboxGeom, skyboxMaterial );
    scene.add( skybox );
    
    //add world elements here
    
    var tiles = [];
    
    var tilesHigh = 36;
    var tilesWide = 23;
    
    var tileHeight = 12;
    var tileWidth = 18;

    for (var j = 0; j < tilesHigh; j++) {

        for (var i = 0; i < tilesWide; i++) {

            var r = Math.floor((Math.random() * 14));

            var tileGeometry = new THREE.BoxGeometry(tileWidth, 0, tileHeight);
         
            var tileMaterial;
         
        if(r == 0){
            tileMaterial = new THREE.MeshLambertMaterial({color: 0x000000, transparent: true, opacity: 0.0});
        } else {    
            tileMaterial = new THREE.MeshLambertMaterial({
                map: textureArray[r]
            });
        }

            var newTile = new THREE.Mesh(tileGeometry, tileMaterial);
            newTile.position.x = i * tileWidth - (tileWidth * tilesWide)/2;
            newTile.position.y = 0;
            newTile.position.z = j * tileHeight - (tileHeight * tilesHigh)/2;

            tiles.push(newTile);

            scene.add(newTile);

        }

    }

}


function init() {

    setup();
    loadResources() ;
    setupSpace();

}


requestAnimationFrame(function animate() {

    renderer.render(scene, camera);
      updateHUD() ;
    requestAnimationFrame(animate);


});

function render() {
       renderer.render(scene, camera);
}

window.addEventListener('resize', onResize, false);
init();
    
</script>




</body>

</html>